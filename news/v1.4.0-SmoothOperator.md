# ðŸ§ˆ v1.4.0 - SmoothOperator

Hello everyone, 

it has been almost half a year since the last release and a lot of new features have been added since then. Besides the most dominant protocol, SMB, other protocols like NFS, LDAP and MSSQL have seen some love with new modules and improvements.

Thank you to everyone who contributed over the past months. And of course, a big thank you to everyone who has been reporting issues on GitHub and helping to troubleshoot or taking part in discussions on Discord. If you want to join our Discord, follow the [link](https://discord.gg/pjwUTQzg8R).

In case you didn't know, this wiki is open source too, and you can contribute to it. If you would like to add missing content or improve existing content, please feel free to do so. Any help is much appreciated! You can find the wiki's source code on GitHub [here](https://github.com/Pennyw0rth/NetExec-Wiki).

## Backup Operator to Domain Admin

As the name suggest, the new module `-M backup_operator` can leverage the Backup Operator privileges to dump the SAM / SECURITY of the DC. This ultimately leads to a full compromise of the domain with the dump of the NTDS.dit. Huge thanks to [@mpgn](https://x.com/mpgn_x64) for this module.

![Backup Operator to full domain compromise](https://github.com/user-attachments/assets/bce85c5a-ffb1-4b17-9d02-acd76b4d51cd)

## Certificate Authentication

NetExec now also supports certificate authentication, thanks to the integration of [@dirkjanm](https://x.com/_dirkjan)'s [PKINITtools](https://github.com/dirkjanm/PKINITtools) authentication mechanisms into NetExec, by [@mpgn](https://x.com/mpgn_x64).

```bash
--pfx-cert/--pfx-base64 with --pfx-pass for PFX certificates
--pem-cert with --pem-key for PEM certificates
```
![Certificate authentication using a pfx certificate](https://github.com/user-attachments/assets/c758b9bc-a587-4ced-84ec-453af69ae90c)

![Certificate authentication using a crt and key certificate](https://github.com/user-attachments/assets/90558bd8-3f81-428e-afb3-97719e7aa231)

## NFS Escape to Root File System

Recent research has shown that the default NFS configuration on Linux systems is often insecure. In short: The NFS server does not check if a requested file is inside the exported directory. This means that if a user has access to the NFS share, they can access any file on the system. In combination with write access, this can lead to a full compromise of the system.

The details of the attack can be found on our wiki page [here](../nfs-protocol/escape-to-root-file-system.md) or on the great blog post by the guys from [HVS Consulting](https://www.hvs-consulting.de/en/blog/nfs-security-identifying-and-exploiting-misconfigurations)

A full implementation of the attack is now available in NetExec, indicates the vulnerability by a new flag in the host banner. The implementation was done by [@NeffIsBack](https://x.com/al3x\_n3ff).

**Note**: With this update, the symantics of the file download and upload flags have been changed. Don't forget to check at the new [flag usage](../nfs-protocol/Download-and-Upload-Files.md).

![Example how to own a debian host with read/write privileges and no_root_squash enabled (the latter is not necessarily needed)](https://github.com/user-attachments/assets/2c2a0f98-3493-42bb-bc26-234836b722f1)

## Timeroasting the Domain

The Timeroast attack has been added as a module to NetExec. This attack allows an attacker on the network to request a hashed&salted version of **any** computer account NT hash in the domain **without** the need for authentication. If you would like to know more about the attack, check out [this article](chrome-extension://oemmndcbldboiebfnladdacbdfmadadm/https://www.secura.com/uploads/whitepapers/Secura-WP-Timeroasting-v3.pdf) from [@SecuraBV](https://x.com/SecuraBV). Made by [@Disgame_](https://x.com/Disgame_).

![Timeroast attack to retriev hashed and salted computer NT hashes](https://github.com/user-attachments/assets/391199264-53d5be8c-4087-45c0-a582-d4cd53416fb6)

## SMB Share Listing Option

You can now list SMB shares directories with new `--dir` SMB flag! Created by [@y0no](https://github.com/y0no).

![Take a look into shares with the new --dir flag](https://github.com/user-attachments/assets/8ef5d270-0b86-4cf8-acee-f4ae370e59e7)

## Automatically Generate Hosts File

NetExec now creates host files for machines enumerated over SMB with `--generate-hosts-file <filename>`, making it easier to add/remove the /etc/hosts in CTFs and in real life. Made by [@mpgn](https://x.com/mpgn_x64).

![Generate the /etc/hosts file with hosts discovered over SMB](https://github.com/user-attachments/assets/ffe68e1f-ea15-4ecc-86b3-abc059064691)

## Automatically Generate KRB5 File

The new SMB flag `--generate-krb5-file <filename>` generates a valid krb5.conf file, similar to `--generate-hosts-file`, to enable Kerberos authentication with other tools. Made by [@mpgn](https://x.com/mpgn_x64).

![Generate a kerberos config file with the SMB](https://github.com/user-attachments/assets/e0655094-72fd-42d0-b9b9-8bceef049a8c)

## Enumerate Delegation Configurations in the Domain

It is now easier to enumerate missconfigured delegation privileges, thanks to the integration by [@termanix](https://github.com/termanix) of impackets findDelegation.py tool. With the new LDAP flag `--find-delegation` any delegation can be found in the domain, including information about the user/computer object and the type of delegation.

![Enumerate delegation configurations in the domain](https://github.com/user-attachments/assets/be853996-137e-4ff2-b46a-0956a208e86d)

## LDAPS Channel Binding now Supported

The new integration of LDAP Channel Binding is now available in Impacket, which means hardened environments are not a problem anymore. The LDAP protocol automatically picks up the required security options and will work out of the box without user interaction. Thanks to [@NeffIsBack](https://x.com/al3x\_n3ff) who took care of the Pull Request in impacket.

![image](https://github.com/user-attachments/assets/3dcb9ff0-e0b6-4df5-b643-3bd662182915)

## BaseDN Flag to LDAP

New LDAP flag `--base-dn` provides the ability to manually specify the baseDN for search requests. It finds the objects, if would not be found by the query. Thanks to [@NeffIsBack](https://x.com/al3x\_n3ff).

![image](https://github.com/user-attachments/assets/e5c7de03-464c-4fd9-9d8d-8d1206da7f39)

## RID Brute Force on MSSQL

Yes, Now MSSQL protocol provides RID brute forcing! `--rid-brute` It uses Transact-SQL queries for that. [@Adamkadaban](https://github.com/Adamkadaban).

![image](https://github.com/user-attachments/assets/6ee1749b-650c-420b-aa5c-76009847035f)

## Coercing on MSSQL

After coerce_plus Module, With the joint development of [@Adamkadaban](https://github.com/Adamkadaban) and [@lodos](https://github.com/lodos2005), coerce attacks can now be performed over MSSQL `-M mssql_coerce `.

![image](https://github.com/user-attachments/assets/272c2b13-53a2-436c-afdc-1a82152ced82)

## Shadow RDP module

That new module `-M shadowrdp` provides enabling remotely Shadow RDP which can be used to eavesdrop on a particular RDP session. Thanks to [@Dfte](https://x.com/Defte_).

![image](https://github.com/user-attachments/assets/0cf2a863-baf5-4df5-9113-99ae029abc38)

## Notepad++ Module

With this module `-M notepad++`, unsaved and thus backed up notepad documents can be dump. It is now important to close tabs while using the App. Thanks to [@Dfte](https://x.com/Defte_).

![image](https://github.com/user-attachments/assets/462b4dc3-1d7e-4fca-9292-04e4e4c39156)

## New Modules on MSSQL

Thanks to [@deathflamingo](https://github.com/deathflamingo), MSSQL protocol has *enum_impersonate*, *enum_logins*, *enum_links*, *exec_on_link*, *link_enable_xp*, *link_xpcmd* modules. With this modules the functionality of MSSQL has increased even more.

## Snipping Tool Module

Now Think twice before copying a screenshot. With this module `-M snipped` newer Windows Snipping Tool of screenshots can bu dumped,  even if it saved the file in another directory. Thanks to [@Yeeb1](https://x.com/Yeeb_).

![image](https://github.com/user-attachments/assets/9bf30f52-ee93-4d68-9fc4-17fe8dcd23cb)

## MSSQL Linked Server

If found MSSQL admin user, linked servers config's can bu find `-M enum_links` with query the login for. Thanks to [@NeffIsBack](https://x.com/al3x\_n3ff).

![image](https://github.com/user-attachments/assets/43ad4bcf-0e19-42d2-9cf5-a69f804b4f32)

## Remove Mic Vulnerability

This new module `-M remove-mic` checks if it target vulnerable to CVE-2019-1040. But dont forget that, it can't check for NTLMv1. Thanks to [@XiaoliChan](https://x.com/Memory_before).

![image](https://github.com/user-attachments/assets/e34cacc8-6601-4039-ba8d-b9739fe7fa3a)

## DPAPI Hash

Interested on dumping DPAPI hashes? This module `-M dpapi_hash` extracts of DPAPI "hash" based on the user's protected masterkey. Thanks to [@nikaiw](https://github.com/nikaiw).

![image](https://github.com/user-attachments/assets/af676b4a-aadc-40f5-b8d5-cf1521d35281)

## Outro
If you want to read about all changes in detail or download the latest standalone binaries check out the github page:

{% embed url="https://github.com/Pennyw0rth/NetExec/releases/tag/v1.4.0" %}
